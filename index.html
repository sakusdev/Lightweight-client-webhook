<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>Discord Webhook 送信ツール</title>
  <style>
    body { font-family: sans-serif; padding: 2em; max-width: 600px; margin: auto; }
    input, textarea, select, button { width: 100%; margin-top: 10px; padding: 8px; }
    .row { display: flex; gap: 10px; }
    .row > * { flex: 1; }
  </style>
</head>
<body>
  <h2>📨 Discord Webhook Sender</h2>

  <label>Webhook URL:</label>
  <select id="webhookSelect"></select>
  <input id="webhookUrl" type="text" placeholder="https://discord.com/api/webhooks/..." />

  <label>ユーザー名:</label>
  <input id="username" type="text" placeholder="Bot名" />

  <label>メッセージ内容:</label>
  <textarea id="content" rows="3" placeholder="ここにメッセージを入力"></textarea>

  <label>Embed タイトル:</label>
  <input id="embedTitle" type="text" placeholder="オプション（埋め込みタイトル）" />

  <label>Embed 説明:</label>
  <textarea id="embedDesc" rows="2" placeholder="オプション（説明文）"></textarea>

  <label>ループ間隔（秒）:</label>
  <input id="interval" type="number" min="1" value="10" />

  <div class="row">
    <button id="sendOnce">📤 一度だけ送信</button>
    <button id="toggleLoop">🔁 ループ開始</button>
  </div>

  <script>
    let intervalId = null;
    const select = document.getElementById('webhookSelect');
    const urlInput = document.getElementById('webhookUrl');

    // 初期Webhookリスト（必要に応じて編集）
    const webhooks = {
      "テスト1": "https://discord.com/api/webhooks/XXXX/AAA",
      "テスト2": "https://discord.com/api/webhooks/YYYY/BBB"
    };

    // セレクトボックスにWebhooks追加
    for (const name in webhooks) {
      const opt = document.createElement('option');
      opt.value = webhooks[name];
      opt.textContent = name;
      select.appendChild(opt);
    }

    // セレクト変更時にURL入力欄更新
    select.addEventListener('change', () => {
      urlInput.value = select.value;
    });
    select.dispatchEvent(new Event('change'));

    // 実際に送信する関数
    function sendWebhook() {
      const url = document.getElementById('webhookUrl').value;
      const content = document.getElementById('content').value;
      const username = document.getElementById('username').value;
      const embedTitle = document.getElementById('embedTitle').value;
      const embedDesc = document.getElementById('embedDesc').value;

      const payload = {
        username,
        content,
        embeds: []
      };

      if (embedTitle || embedDesc) {
        payload.embeds.push({
          title: embedTitle || undefined,
          description: embedDesc || undefined,
          color: 0x00bfff
        });
      }

      fetch(url, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(payload)
      }).then(res => {
        if (!res.ok) alert('送信失敗: ' + res.statusText);
      }).catch(err => alert('エラー: ' + err));
    }

    // ボタンクリックイベント
    document.getElementById('sendOnce').onclick = sendWebhook;

    document.getElementById('toggleLoop').onclick = function () {
      if (intervalId) {
        clearInterval(intervalId);
        intervalId = null;
        this.textContent = '🔁 ループ開始';
      } else {
        const intervalSec = parseInt(document.getElementById('interval').value) || 10;
        intervalId = setInterval(sendWebhook, intervalSec * 1000);
        this.textContent = '⏹️ ループ停止';
      }
    };
  </script>
</body>
</html>
