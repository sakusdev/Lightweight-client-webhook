<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>Discord Webhook 送信クライアント</title>
  <style>
    body {
      font-family: sans-serif;
      padding: 20px;
      background: #f8f9fa;
    }
    input, button {
      margin: 5px 0;
      padding: 8px;
      width: 100%;
    }
    button {
      width: 49%;
    }
  </style>
</head>
<body>
  <h1>💬 Discord Webhook 定期送信クライアント</h1>

  <label>
    Webhook URL:
    <input type="text" id="webhookUrl" placeholder="https://discord.com/api/webhooks/..." />
  </label>

  <label>
    メッセージ内容:
    <input type="text" id="message" value="こんにちは、Discord!" />
  </label>

  <label>
    送信間隔（秒）:
    <input type="number" id="interval" value="10" min="1" />
  </label>

  <div>
    <button onclick="start()">▶ 送信開始</button>
    <button onclick="stop()">⏹ 停止</button>
  </div>

  <p id="status">ステータス: 停止中</p>

  <script>
    let timerId = null;

    function sendMessage() {
      const url = document.getElementById('webhookUrl').value;
      const message = document.getElementById('message').value;
      if (!url || !message) {
        alert("Webhook URLとメッセージを入力してください。");
        return;
      }

      fetch(url, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ content: message })
      }).then(res => {
        if (!res.ok) {
          document.getElementById("status").textContent = "ステータス: エラー（" + res.status + "）";
        }
      }).catch(err => {
        console.error(err);
        document.getElementById("status").textContent = "ステータス: 送信エラー";
      });
    }

    function start() {
      if (timerId) {
        alert("すでに送信中です。");
        return;
      }

      const intervalSec = parseInt(document.getElementById("interval").value, 10);
      if (isNaN(intervalSec) || intervalSec <= 0) {
        alert("間隔は1以上の数字で入力してください。");
        return;
      }

      sendMessage(); // まず1回即送信
      timerId = setInterval(sendMessage, intervalSec * 1000);
      document.getElementById("status").textContent = "ステータス: 送信中（" + intervalSec + "秒ごと）";
    }

    function stop() {
      if (timerId) {
        clearInterval(timerId);
        timerId = null;
        document.getElementById("status").textContent = "ステータス: 停止中";
      }
    }
  </script>
</body>
</html>
